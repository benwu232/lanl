
name: 'model101'
n_process: 0

env:
  root_path: '/media/wb/backup/work/LANL-Earthquake-Prediction'
  with_log: 0
  with_tblog: 0

model:
  name: 'WaveNet'
  n_stacks: 1
  layers_per_stack: 12
  kernel_size: 2
  n_features: 32
  n_blk_res: 16
  n_blk_skip: 16
  bias: True
  init_type: 'xavier_normal'
  act_type: 'tanh'
  wn_dropout_keep: 1.0
  fc_dropout_keep: 0.5
  use_weight_norm: False

opt:
  type: 'Adam'
  beta1: 0.9
  beta2: 0.999
  weight_decay: 0.0
  epsilon: !!float 1e-8

trn:
  #pretrained_file: 'Arc_11'
  #pretrained_file: 'CosNet-known-densenet121-best'
  #pretrained_file: 'CosNet-known-densenet121-8'
  batch_size: 64
  batches_per_epoch: 500
  n_epoch: 600
  patience: 100
  balance: 0
  method: 1
  true_wd: True
  wd: !!float 1e-2
  max_lr: !!float 1e-3
  #true_wd: False
  #wd: !!float 3e-5
  new_whale: 0
  use_flip: 0
  cal_score: 'mapk_known'
  find_lr: False

vld:
  n_known: 1000
  n_unknown: -1
  seed: 97
  cal_metric_once: True
  batch_size: 32

loss:
  name: 'MAE'
  reduction: 'mean'



#transform:
#  name: 'align_transform'
#  num_preprocessor: 6
#  params:
#    size: 320
#    align: True
#    align_p: 0.5

scoreboard:
  len: 11
  sort: 'dec'

