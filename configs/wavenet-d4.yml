
name: &name 'lanl'
DBG: 0
n_process: 2


raw_len: &raw_len 150_000
#seq_len: &seq_len 4096
seq_len: &seq_len 256
vld_idx: 0

env:
  root_path: '/media/wb/backup/work/LANL-Earthquake-Prediction'
  input_data: ~
  with_log: 1
  with_tblog: 1

model:
  name: &model_name 'wavenet'
  model_file: 'lanl_WaveNet_16_s[1]_wnd[0.95]_fcd[0.95]_l2[0.1]_add_256-195.h5'
  legacy: False
  seq_len: *seq_len
  raw_len: *raw_len
  shrinked_len: 50
  stacks: &stacks 1
  #layers: 26
  #layers_per_stack: 10
  layers_per_stack: &lps 4
  #layers_per_stack: 13
  kernel_size: &kernel_size 4
  dilation_base: *kernel_size
  in_features: 36
  #n_features: 512
  n_filters: &n_filters 16
  n_out_filters: &n_out_filters 8
  use_bias: True
  l2_factor: !!float 6e-2
  #l2_factor: 0.0
  final_l2_factor: 0.0
  merge_type: 'add'
  #merge_type: 'concat'

  wn_dropout: 0.95
  norm_type: 'batch_norm'
  #norm_type: 'none'
  fc_dropout: 0.95
  use_weight_norm: False

opt:
  type: 'Adam'
  lr: !!float 1e-3
  beta1: 0.9
  beta2: 0.999
  weight_decay: !!float 1e-4
  epsilon: !!float 1e-8

trn:
  #pretrained_file: 'Arc_11'
  #pretrained_file: 'CosNet-known-densenet121-best'
  #pretrained_file: 'CosNet-known-densenet121-8'
  batch_size: 64
  batches_per_epoch: 250
  n_epoch: 10000
  patience: 200
  balance: 0
  method: 1
  true_wd: True
  wd: !!float 1e-2
  max_lr: !!float 1e-3
  #true_wd: False
  #wd: !!float 3e-5
  find_lr: 0

vld:
  batch_size: 64
  batches_per_epoch: 100

ds:
  vld_seg: [13, 14, 15]
  fix_seed: 1
  k_fold: 5
  fold: 4
  raw_len: *raw_len
  seq_len: *seq_len

loss:
  name: 'MAE'
  reduction: 'mean'



#transform:
#  name: 'align_transform'
#  num_preprocessor: 6
#  params:
#    size: 320
#    align: True
#    align_p: 0.5

scoreboard:
  len: 11
  sort: 'inc'


id:
  - *name
  - *model_name
  - *seq_len
  - *stacks
  - *lps
  - *kernel_size
  - *n_filters
  - *n_out_filters
